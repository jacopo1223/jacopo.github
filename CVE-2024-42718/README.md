# Proof of Concept: Path Traversal

# Application: Croogo 4.0.7

# Vulnerability Type
**POST-AUTH** Path Traversal This vulnerability requires the attacker to be authenticated in order to exploit it.

# Vulnerability Description. 
The Path Traversal vulnerability allows an authenticated attacker to access sensitive files on the server by manipulating the path parameter in the file manager endpoint. This allows arbitrary files to be read outside of the web root directory, such as /etc/passwd. 

# Steps taken:

I was able to log in to the application using the default **croogo/croogo** credentials. 

![Login Screenshot](https://github.com/jacopo1223/jacopo.github/blob/main/CVE-2024-42718/login.png?raw=true)

Next, I navigated to a page that contained a file manager, through which it was possible to edit the files present.

![2 Step Screenshot](https://github.com/jacopo1223/jacopo.github/blob/main/CVE-2024-42718/2%20step.png?raw=true)

I noted with interest that, using this feature, it was possible not only to edit files, but also to view certain directories on the system.

![Step 3 Screenshot](https://github.com/jacopo1223/jacopo.github/blob/main/CVE-2024-42718/step%203.png?raw=true)


After several attempts, I blocked a request using Burp Suite and made a change and was able to gain access to the /etc/passwd file. 
**GET /admin/file-manager/file-manager/edit-file?path=../../../../../../etc/passwd**

![Step 4 Screenshot](https://github.com/jacopo1223/jacopo.github/blob/main/CVE-2024-42718/step4.jpg?raw=true)




# Recommended Mitigations

1. Input Validation:
   - Implement rigorous validation and sanitisation of user-supplied input. This must include the removal of sequences such as ../ that could be used to traverse directories.

2. Access Control:
   - Apply strict access controls to ensure that only authorised users can access specific endpoints or files. Restrict access to sensitive system files.

3. Path Normalisation:
   - Use path normalisation techniques to ensure that file paths are canonicalised before accessing the file system. This reduces the risk of manipulated paths being used to access unauthorised files.

4. Server Configuration:
   - Configure the web server so that sensitive files are never accessed via the web server. This includes the use of appropriate access rules and the segregation of sensitive directories from public web content.



